"use strict";(self.webpackChunkbook_it_coworking_frontend=self.webpackChunkbook_it_coworking_frontend||[]).push([[6258],{"./src/components/Booking/Booking.stories.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Example:function(){return Example},__namedExportsOrder:function(){return __namedExportsOrder},default:function(){return Booking_stories}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-router/dist/index.js"),clsx=__webpack_require__("./node_modules/clsx/dist/clsx.mjs"),dayjs_min=__webpack_require__("./node_modules/dayjs/dayjs.min.js"),dayjs_min_default=__webpack_require__.n(dayjs_min),currentUserContext=(__webpack_require__("./node_modules/dayjs/locale/ru.js"),__webpack_require__("./src/contexts/currentUserContext.js")),Api=__webpack_require__("./src/utils/Api.jsx"),Button=__webpack_require__("./src/components/UI-kit/Button/Button.jsx"),SectionTitle=__webpack_require__("./src/components/SectionTitle/SectionTitle.jsx"),Calendar=__webpack_require__("./src/components/Calendar/Calendar.jsx"),TabSwitcher=__webpack_require__("./src/components/TabSwitcher/TabSwitcher.jsx"),ButtonsList=__webpack_require__("./src/components/ButtonsList/ButtonsList.jsx"),constants=__webpack_require__("./src/utils/constants.jsx"),useResize=__webpack_require__("./src/hooks/useResize.jsx"),hooks_useInitialVisibilityState=function useInitialVisibilityState(){var _useState=(0,react.useState)({isMobileView:!1,dateSection:{isVisible:!1,stepNumber:1},spotsSection:{isVisible:!1,stepNumber:2},dividedSpotTypesSection:{isVisible:!1,stepNumber:1}}),_useState2=(0,slicedToArray.Z)(_useState,2),resultState=_useState2[0],setResultState=_useState2[1],isScreenSmall=(0,useResize.a)().isScreenSmall;return(0,react.useEffect)((function(){setResultState(isScreenSmall?{isMobileView:!0,dateSection:{isVisible:!1,stepNumber:2},spotsSection:{isVisible:!1,stepNumber:3},dividedSpotTypesSection:{isVisible:!0,stepNumber:1}}:{isMobileView:!1,dateSection:{isVisible:!0,stepNumber:1},spotsSection:{isVisible:!1,stepNumber:2},dividedSpotTypesSection:{isVisible:!1,stepNumber:1}})}),[isScreenSmall]),resultState},BookingCalendarPopup=__webpack_require__("./src/components/BookingCalendarPopup/BookingCalendarPopup.jsx"),SortData=__webpack_require__("./src/components/UI-kit/SortData/SortData.jsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");dayjs_min_default().locale("ru");var getDateString=function getDateString(date){var month=date.getMonth()+1,monthString=month<10?"0".concat(month):month.toString();return"".concat(date.getFullYear(),"-").concat(monthString,"-").concat(date.getDate())},getTimeWithZeroPrefixedMinutes=function getTimeWithZeroPrefixedMinutes(timeArray){var resultTime="".concat(timeArray[0],":");return resultTime="".concat(resultTime).concat(timeArray[1]<10?"0".concat(timeArray[1]):timeArray[1])},getRangeItem=function getRangeItem(id,startTime,endTime,onItemClick){return{id:id,name:"".concat(getTimeWithZeroPrefixedMinutes(startTime)," - ").concat(getTimeWithZeroPrefixedMinutes(endTime)),startTime:startTime.map((function(item){return item<10?"0".concat(item):item})).join(":"),endTime:endTime.map((function(item){return item<10?"0".concat(item):item})).join(":"),onClick:onItemClick,isEnabled:!0}},getHourAndMinutes=function getHourAndMinutes(time){return time.split(":").map((function(item){return parseInt(item,10)}))},timeSortFunc=function timeSortFunc(a,b){var _getHourAndMinutes9=getHourAndMinutes(a.startTime),_getHourAndMinutes10=(0,slicedToArray.Z)(_getHourAndMinutes9,2),firstHour=_getHourAndMinutes10[0],firstMinutes=_getHourAndMinutes10[1],_getHourAndMinutes11=getHourAndMinutes(b.startTime),_getHourAndMinutes12=(0,slicedToArray.Z)(_getHourAndMinutes11,2),secondHour=_getHourAndMinutes12[0],secondMinutes=_getHourAndMinutes12[1];return firstHour===secondHour?firstMinutes-secondMinutes:firstHour-secondHour},spotsSortFunc=function spotsSortFunc(a,b){return parseInt(a.name,10)-parseInt(b.name,10)},Booking_Booking=function Booking(){var _ref,_ref3,_ref5,_ref6,_ref8,_ref11,_ref12,location=(0,dist.TH)(),navigate=(0,dist.s0)(),coworking=(0,react.useRef)(location.state),_useState=(0,react.useState)(coworking),_useState2=(0,slicedToArray.Z)(_useState,2),currentCoworkingState=_useState2[0],setCurrentCoworkingState=_useState2[1],_useState3=(0,react.useState)(""),_useState4=(0,slicedToArray.Z)(_useState3,2),planPhoto=_useState4[0],setPlanPhoto=_useState4[1],_useState5=(0,react.useState)([]),_useState6=(0,slicedToArray.Z)(_useState5,2),datesSelected=_useState6[0],setDatesSelected=_useState6[1],_useState7=(0,react.useState)([]),_useState8=(0,slicedToArray.Z)(_useState7,2),timeRangesSelected=_useState8[0],setTimeRangesSelected=_useState8[1],_useState9=(0,react.useState)([]),_useState10=(0,slicedToArray.Z)(_useState9,2),spotsSelected=_useState10[0],setSpotsSelected=_useState10[1],_useState11=(0,react.useState)([]),_useState12=(0,slicedToArray.Z)(_useState11,2),meetingRoomsSelected=_useState12[0],setMeetingRoomsSelected=_useState12[1],_useState13=(0,react.useState)(""),_useState14=(0,slicedToArray.Z)(_useState13,2),currentSpotPrice=_useState14[0],setCurrentSpotPrice=_useState14[1],_useState15=(0,react.useState)(""),_useState16=(0,slicedToArray.Z)(_useState15,2),currentMeetingPrice=_useState16[0],setCurrentMeetingPrice=_useState16[1],_useState17=(0,react.useState)(""),_useState18=(0,slicedToArray.Z)(_useState17,2),totalPrice=_useState18[0],setTotalPrice=_useState18[1],_useState19=(0,react.useState)([]),_useState20=(0,slicedToArray.Z)(_useState19,2),spots=_useState20[0],setSpots=_useState20[1],_useState21=(0,react.useState)([]),_useState22=(0,slicedToArray.Z)(_useState21,2),meetingRooms=_useState22[0],setMeetingRooms=_useState22[1],_useState23=(0,react.useState)(!0),_useState24=(0,slicedToArray.Z)(_useState23,2),isSpotsEnabled=_useState24[0],setSpotsEnabled=_useState24[1],_useState25=(0,react.useState)(!1),_useState26=(0,slicedToArray.Z)(_useState25,2),isWorkplacesEnabled=_useState26[0],setWorkplacesEnabled=_useState26[1],_useState27=(0,react.useState)(!1),_useState28=(0,slicedToArray.Z)(_useState27,2),isMeetingRoomsEnabled=_useState28[0],setMeetingRoomsEnabled=_useState28[1],_useState29=(0,react.useState)(!1),_useState30=(0,slicedToArray.Z)(_useState29,2),isPlanPhotoVisible=_useState30[0],setIsPlanPhotoVisible=_useState30[1],_useState31=(0,react.useState)(!1),_useState32=(0,slicedToArray.Z)(_useState31,2),isDatePopupOpened=_useState32[0],setDatePopupOpened=_useState32[1],showMessage=(0,react.useContext)(currentUserContext.E).showMessage,_useState33=(0,react.useState)("Выбрать дату и время"),_useState34=(0,slicedToArray.Z)(_useState33,2),chooseDateButtonText=_useState34[0],setChooseDateButtonText=_useState34[1],initialVisibilityState=hooks_useInitialVisibilityState(),_useState35=(0,react.useState)(initialVisibilityState),_useState36=(0,slicedToArray.Z)(_useState35,2),sectionsVisibility=_useState36[0],setSectionsVisibility=_useState36[1],permittedSpots=(0,react.useMemo)((function(){return[{text:"--",id:-1}].concat((0,toConsumableArray.Z)(spots.filter((function(item){return item.isEnabled})).sort(spotsSortFunc).map((function(item){return{text:item.name,id:item.id}}))))}),[spots]),updateSectionsVisibility=function updateSectionsVisibility(initiator){switch(initiator){case"time":setSectionsVisibility((function(prev){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},prev),{},{spotsSection:(0,objectSpread2.Z)((0,objectSpread2.Z)({},prev.spotsSection),{},{isVisible:!0})})}));break;case"spotType":setSectionsVisibility((function(prev){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},prev),{},{dateSection:(0,objectSpread2.Z)((0,objectSpread2.Z)({},prev.dateSection),{},{isVisible:!0})})}))}},handleCalendarClick=function handleCalendarClick(dates){setDatesSelected(dates)},handleTimeItemClick=function handleTimeItemClick(_x){return(_ref=_ref||(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(selectedRanges){return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:setTimeRangesSelected(selectedRanges);case 1:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)},_useState37=(0,react.useState)([]),_useState38=(0,slicedToArray.Z)(_useState37,2),timeRangeItems=_useState38[0],setTimeRangeItems=_useState38[1],allowedRanges=(0,react.useMemo)((function(){return function getAllowedRanges(baseRanges,itemsList){return baseRanges.reduce((function(ranges,allowedRange){var _getHourAndMinutes=getHourAndMinutes(allowedRange.startTime),_getHourAndMinutes2=(0,slicedToArray.Z)(_getHourAndMinutes,2),allowedRangeStartHour=_getHourAndMinutes2[0],allowedRangeStartMinutes=_getHourAndMinutes2[1],_getHourAndMinutes3=getHourAndMinutes(allowedRange.endTime),_getHourAndMinutes4=(0,slicedToArray.Z)(_getHourAndMinutes3,2),allowedRangeEndHour=_getHourAndMinutes4[0],allowedRangeEndMinutes=_getHourAndMinutes4[1],range=itemsList.reduce((function(itemsRange,item){var _getHourAndMinutes5=getHourAndMinutes(item.startTime),_getHourAndMinutes6=(0,slicedToArray.Z)(_getHourAndMinutes5,2),itemStartHour=_getHourAndMinutes6[0],itemStartMinutes=_getHourAndMinutes6[1],_getHourAndMinutes7=getHourAndMinutes(item.endTime),_getHourAndMinutes8=(0,slicedToArray.Z)(_getHourAndMinutes7,2),itemEndHour=_getHourAndMinutes8[0],itemEndMinutes=_getHourAndMinutes8[1];return itemStartHour>=allowedRangeStartHour&&itemStartMinutes>=allowedRangeStartMinutes&&itemEndHour<=allowedRangeEndHour&&itemEndMinutes<=allowedRangeEndMinutes&&itemsRange.push(item.id),itemsRange}),[]);return range.length>0&&ranges.push(range),ranges}),[])}(constants.mG,timeRangeItems)}),[timeRangeItems]),handleSwitcherClick=function handleSwitcherClick(selectedSpotType){if(selectedSpotType===constants.RU)return setSpotsEnabled(!0),void setMeetingRoomsEnabled(!1);setSpotsEnabled(!1),setMeetingRoomsEnabled(!0)},handleSpotTypeClick=function handleSpotTypeClick(selectedSpotType){updateSectionsVisibility("spotType"),handleSwitcherClick(selectedSpotType)},spotTypes=(0,react.useRef)([{id:0,name:constants.RU,onClick:function onClick(){return handleSpotTypeClick(constants.RU)},isEnabled:!0},{id:1,name:constants.mb,onClick:function onClick(){return handleSpotTypeClick(constants.mb)},isEnabled:!0}]),handleSpotSelect=function handleSpotSelect(selectedItems){setSpotsSelected(selectedItems)},handleMeetingRoomSelect=function handleMeetingRoomSelect(selectedItems){setMeetingRoomsSelected(selectedItems)},getSelectedPrice=function getSelectedPrice(selectedItems){return selectedItems.reduce((function(sum,item){return sum+parseInt(item.price,10)}),0)},calendarExtraRules=(0,react.useCallback)((function(){return[function(date){return function getWeekDayNumber(date){var dayNumber=date.getDay();return 0===dayNumber?7:dayNumber}(date)>constants.PG[currentCoworkingState.daysOpen]}]}),[currentCoworkingState])(),getWorkplacesData=(0,react.useCallback)((function(_x2){return(_ref5=_ref5||(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee3(_ref4){var id,date,startTime,endTime,result,spotsData,meetingRoomsData;return(0,regeneratorRuntime.Z)().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return id=_ref4.id,date=_ref4.date,startTime=_ref4.startTime,endTime=_ref4.endTime,result={},_context3.prev=2,_context3.next=5,(0,Api.T4)(id,{category:constants.Zq,date:date,start_time:startTime,end_time:endTime});case 5:return spotsData=_context3.sent.map((function(item){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},item),{},{isEnabled:!item.is_ordered,onClick:handleSpotSelect})})),_context3.next=8,(0,Api.T4)(id,{category:constants.Yi,date:date,start_time:startTime,end_time:endTime});case 8:meetingRoomsData=_context3.sent.map((function(item){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},item),{},{isEnabled:!item.is_ordered,onClick:handleMeetingRoomSelect})})),result={spots:spotsData,meetingRooms:meetingRoomsData},_context3.next=15;break;case 12:_context3.prev=12,_context3.t0=_context3.catch(2),console.log(_context3.t0.message);case 15:return _context3.abrupt("return",result);case 16:case"end":return _context3.stop()}}),_callee3,null,[[2,12]])})))).apply(this,arguments)}),[]),mergeSpotsStates=function mergeSpotsStates(firstSpots,secondSpots){return firstSpots?secondSpots?firstSpots.map((function(firtsItem){var secondItem=secondSpots.find((function(item){return firtsItem.id===item.id}));return(0,objectSpread2.Z)((0,objectSpread2.Z)({},firtsItem),{},{isEnabled:firtsItem.isEnabled&&secondItem.isEnabled})})):firstSpots:secondSpots},getSpotsStatesByDividedTimes=(0,react.useCallback)((function(_x3){return(_ref6=_ref6||(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee5(selectedDate){var _ref7,result;return(0,regeneratorRuntime.Z)().wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,timeRangesSelected.reduce((function(_x4,_x5){return(_ref7=_ref7||(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee4(timeResult,timeRange){var previousTimeResult,timeItem,preparedDate,receivedWorkplaces;return(0,regeneratorRuntime.Z)().wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,timeResult;case 2:if(previousTimeResult=_context4.sent,timeItem=timeRangeItems.find((function(item){return item.id===timeRange.id}))){_context4.next=6;break}return _context4.abrupt("return",timeResult);case 6:return preparedDate="".concat(selectedDate.getFullYear(),"-").concat(selectedDate.getMonth()+1,"-").concat(selectedDate.getDate()),_context4.next=9,getWorkplacesData({id:coworking.current.id,date:preparedDate,startTime:timeItem.startTime,endTime:timeItem.endTime});case 9:return receivedWorkplaces=_context4.sent,_context4.abrupt("return",{spots:mergeSpotsStates(previousTimeResult.spots,receivedWorkplaces.spots),meetingRooms:mergeSpotsStates(previousTimeResult.meetingRooms,receivedWorkplaces.meetingRooms)});case 11:case"end":return _context4.stop()}}),_callee4)})))).apply(this,arguments)}),{});case 2:return result=_context5.sent,_context5.abrupt("return",result);case 4:case"end":return _context5.stop()}}),_callee5)})))).apply(this,arguments)}),[getWorkplacesData,timeRangeItems,timeRangesSelected]),getSpotsStates=(0,react.useCallback)((function(_x6){return(_ref8=_ref8||(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee6(selectedDate){var _timeRangesSelected$a,startTime,_timeRangesSelected$a2,endTime,preparedDate,receivedWorkplaces;return(0,regeneratorRuntime.Z)().wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _timeRangesSelected$a=timeRangesSelected.at(0),startTime=_timeRangesSelected$a.startTime,_timeRangesSelected$a2=timeRangesSelected.at(-1),endTime=_timeRangesSelected$a2.endTime,preparedDate="".concat(selectedDate.getFullYear(),"-").concat(selectedDate.getMonth()+1,"-").concat(selectedDate.getDate()),_context6.next=5,getWorkplacesData({id:coworking.current.id,date:preparedDate,startTime:startTime,endTime:endTime});case 5:return receivedWorkplaces=_context6.sent,_context6.abrupt("return",{spots:receivedWorkplaces.spots,meetingRooms:receivedWorkplaces.meetingRooms});case 7:case"end":return _context6.stop()}}),_callee6)})))).apply(this,arguments)}),[getWorkplacesData,timeRangesSelected]),loadWorkplaces=(0,react.useCallback)((0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee8(){var _ref10,resultSpots;return(0,regeneratorRuntime.Z)().wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,datesSelected.reduce((function(_x7,_x8){return(_ref10=_ref10||(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee7(dateResult,selectedDate){var previousDateResult,dateSpots,mergedLists;return(0,regeneratorRuntime.Z)().wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,dateResult;case 2:previousDateResult=_context7.sent,dateSpots={},_context7.next=10;break;case 7:dateSpots=_context7.sent,_context7.next=13;break;case 10:return _context7.next=12,getSpotsStates(selectedDate);case 12:dateSpots=_context7.sent;case 13:return mergedLists={spots:mergeSpotsStates(previousDateResult.spots,dateSpots.spots),meetingRooms:mergeSpotsStates(previousDateResult.meetingRooms,dateSpots.meetingRooms)},_context7.abrupt("return",mergedLists);case 15:case"end":return _context7.stop()}}),_callee7)})))).apply(this,arguments)}),{});case 2:(resultSpots=_context8.sent).spots&&(setSpots(resultSpots.spots),setMeetingRooms(resultSpots.meetingRooms));case 4:case"end":return _context8.stop()}}),_callee8)}))),[false,datesSelected,getSpotsStatesByDividedTimes,getSpotsStates]),loadWorkplacesInitial=(0,react.useCallback)((function(_x9){return(_ref11=_ref11||(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee9(coworkingState){var date,tomorrowDate,preparedDate,resultSpots;return(0,regeneratorRuntime.Z)().wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return date=new Date,tomorrowDate=new Date(date.getFullYear(),date.getMonth(),date.getDate()+1),preparedDate="".concat(tomorrowDate.getFullYear(),"-").concat(tomorrowDate.getMonth()+1,"-").concat(tomorrowDate.getDate()),_context9.next=5,getWorkplacesData({id:coworkingState.id,date:preparedDate,startTime:coworkingState.openTime,endTime:coworkingState.closeTime});case 5:resultSpots=_context9.sent,setSpots(resultSpots.spots),setMeetingRooms(resultSpots.meetingRooms);case 8:case"end":return _context9.stop()}}),_callee9)})))).apply(this,arguments)}),[getWorkplacesData]),loadPlanPhoto=(0,react.useCallback)((function(_x10){return(_ref12=_ref12||(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee10(locationId){var _yield$getLocationPla,image;return(0,regeneratorRuntime.Z)().wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _context10.prev=0,_context10.next=3,(0,Api.v5)(locationId);case 3:_yield$getLocationPla=_context10.sent,image=_yield$getLocationPla.image,setPlanPhoto(image),_context10.next=11;break;case 8:_context10.prev=8,_context10.t0=_context10.catch(0),console.log(_context10.t0.message);case 11:case"end":return _context10.stop()}}),_callee10,null,[[0,8]])})))).apply(this,arguments)}),[]),getAvailableTimeRanges=(0,react.useCallback)((function(currentTimeRanges){return currentTimeRanges.map((function(timeRange){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},timeRange),{},{isEnabled:!datesSelected.some((function(date){var todayDate=new Date;if(function isSameDateDay(firstDate,secondDate){var firstDay=new Date(firstDate.getFullYear(),firstDate.getMonth(),firstDate.getDate()),secondDay=new Date(secondDate.getFullYear(),secondDate.getMonth(),secondDate.getDate());return firstDay.getTime()===secondDay.getTime()}(date,todayDate)){var _getHourAndMinutes13=getHourAndMinutes(timeRange.startTime),_getHourAndMinutes14=(0,slicedToArray.Z)(_getHourAndMinutes13,2),rangeStartHour=_getHourAndMinutes14[0],rangeStartMinutes=_getHourAndMinutes14[1],todayHour=todayDate.getHours(),todayMinutes=todayDate.getMinutes();return!(rangeStartHour>todayHour)&&(rangeStartHour!==todayHour||rangeStartMinutes<todayMinutes)}return!1}))})}))}),[datesSelected]);return(0,react.useEffect)((function(){setSectionsVisibility(initialVisibilityState)}),[initialVisibilityState]),(0,react.useEffect)((function(){isSpotsEnabled||setSpotsSelected([]),isMeetingRoomsEnabled||setMeetingRoomsSelected([]),isWorkplacesEnabled||(setSpotsSelected([]),setMeetingRoomsSelected([]))}),[isSpotsEnabled,isMeetingRoomsEnabled,isWorkplacesEnabled]),(0,react.useEffect)((function(){var spotPrice=getSelectedPrice(spotsSelected);setCurrentSpotPrice(0===spotPrice?"​":"".concat(spotPrice," ₽/час"));var meetingRoomPrice=getSelectedPrice(meetingRoomsSelected);setCurrentMeetingPrice(0===meetingRoomPrice?"​":"".concat(meetingRoomPrice," ₽/час")),setTotalPrice(spotPrice*timeRangesSelected.length+meetingRoomPrice*timeRangesSelected.length)}),[spotsSelected,meetingRoomsSelected,timeRangesSelected]),(0,react.useEffect)((function(){if(timeRangesSelected.length>0)return updateSectionsVisibility("time"),loadWorkplaces(),void setWorkplacesEnabled(!0);setWorkplacesEnabled(!1)}),[timeRangesSelected,loadWorkplaces]),(0,react.useEffect)((function(){datesSelected.length>0&&setTimeRangeItems(getAvailableTimeRanges),setTimeRangesSelected([])}),[datesSelected,getAvailableTimeRanges]),(0,react.useEffect)((function(){var coworkingState=JSON.parse(sessionStorage.getItem("coworkingState"));if(coworking.current||coworkingState){coworking.current||(coworking.current=coworkingState),setCurrentCoworkingState(coworking.current),sessionStorage.setItem("coworkingState",JSON.stringify(coworking.current));var _coworking$current=coworking.current,id=_coworking$current.id,openTime=_coworking$current.openTime,closeTime=_coworking$current.closeTime;setTimeRangeItems(function getTimeRangeItems(startTime,endTime,onItemClick){var _startTime$split$map=startTime.split(":").map((function(i){return parseInt(i,10)})),_startTime$split$map2=(0,slicedToArray.Z)(_startTime$split$map,2),startHour=_startTime$split$map2[0],startMinutes=_startTime$split$map2[1],_endTime$split$map=endTime.split(":").map((function(i){return parseInt(i,10)})),_endTime$split$map2=(0,slicedToArray.Z)(_endTime$split$map,2),endHour=_endTime$split$map2[0],endMinutes=_endTime$split$map2[1],resultRanges=[];if(startHour>endHour)throw new Error("End hour can't be less than start hour: start hour - \"".concat(startHour,'", end hour - ').concat(endHour));for(var i=0;i<endHour-startHour;i+=1){var rangeStartHour=startHour+i,rangeEndHour=rangeStartHour+1,rangeStartTime=[rangeStartHour,startMinutes],rangeEndTime=[rangeEndHour,startMinutes];if(rangeStartHour===endHour&&startMinutes>=endMinutes)break;if(rangeStartHour===endHour&&startMinutes<endMinutes){resultRanges.push(getRangeItem(i,rangeStartTime,"".concat(rangeEndHour,":").concat(endMinutes),onItemClick));break}rangeEndHour===endHour&&(rangeEndTime=[rangeEndHour,endMinutes]),resultRanges.push(getRangeItem(i,rangeStartTime,rangeEndTime,onItemClick))}return resultRanges}(openTime,closeTime,handleTimeItemClick)),loadPlanPhoto(id),loadWorkplacesInitial(coworking.current)}else navigate("/",{replace:!0})}),[loadPlanPhoto,loadWorkplacesInitial,navigate]),(0,jsx_runtime.jsxs)("main",{className:"booking","aria-label":"Страница бронирования",children:[initialVisibilityState.isMobileView&&(0,jsx_runtime.jsx)(BookingCalendarPopup.Z,{onDateSelect:handleCalendarClick,onClickClose:function handleCloseDatePopup(){setDatesSelected([]),setTimeRangesSelected([]),setDatePopupOpened(!1),setChooseDateButtonText("Выбрать дату и время")},onSaveClick:function handleSaveDatePopup(){if(setDatePopupOpened(!1),datesSelected.length>0&&timeRangesSelected.length>0){var dateText=dayjs_min_default()(datesSelected.at(0)).format("D MMMM YYYY"),timeText="".concat(timeRangesSelected.at(0).startTime,"-").concat(timeRangesSelected.at(-1).endTime);setChooseDateButtonText("".concat(dateText," ").concat(timeText))}else setChooseDateButtonText("Выбрать дату и время")},isOpen:isDatePopupOpened,timeListProps:{isEnabled:datesSelected.length>0,itemsList:timeRangeItems,allowedRanges:allowedRanges,sortFunc:timeSortFunc,isMultiselect:false,listClassName:"booking__buttons-list booking__buttons-list_type_time-ranges"}}),(0,jsx_runtime.jsx)(Button.Z,{onClick:function handleBackButton(e){e.preventDefault(),navigate("/points")},btnClass:"button_type_back",btnText:"Назад"}),(0,jsx_runtime.jsx)(SectionTitle.N,{titleText:"Бронирование",titleClass:"section-title_booking"}),sectionsVisibility.dividedSpotTypesSection.isVisible&&(0,jsx_runtime.jsxs)("section",{className:"booking__section","aria-label":"Секция выбора типа рабочего времени",children:[(0,jsx_runtime.jsxs)("h2",{className:"booking__section-title",children:[sectionsVisibility.dividedSpotTypesSection.stepNumber,". Выберите тип рабочего места"]}),(0,jsx_runtime.jsx)(ButtonsList.C,{itemsList:spotTypes.current,itemsClassName:"button_type_booking booking__spot-type-button",disableDeselect:!0,listClassName:"booking__buttons-list booking__buttons-list_type_spot-types"})]}),sectionsVisibility.dateSection.isVisible&&(0,jsx_runtime.jsxs)("section",{className:"booking__section","aria-label":"Секция выбора даты и времени",style:{"--buttons-list-rows-main":Math.ceil(timeRangeItems.length/5),"--buttons-list-rows-1256":Math.ceil(timeRangeItems.length/4),"--buttons-list-rows-1064":Math.ceil(timeRangeItems.length/3),"--buttons-list-rows-1024":Math.ceil(timeRangeItems.length/4),"--buttons-list-rows-944":Math.ceil(timeRangeItems.length/3),"--buttons-list-rows-594":Math.ceil(timeRangeItems.length/2)},children:[(0,jsx_runtime.jsxs)("h2",{className:"booking__section-title",children:[sectionsVisibility.dateSection.stepNumber,". Выберите дату и время"]}),initialVisibilityState.isMobileView?(0,jsx_runtime.jsx)(Button.Z,{onClick:function handleOpenDatePopup(){setDatePopupOpened(!0)},btnClass:"booking__choose-date-button button_type_transparent",btnText:chooseDateButtonText}):(0,jsx_runtime.jsxs)("div",{className:"booking__flex-container",children:[(0,jsx_runtime.jsx)(Calendar.f,{selectCallback:handleCalendarClick,extraRules:calendarExtraRules}),(0,jsx_runtime.jsx)(ButtonsList.C,{isEnabled:datesSelected.length>0,itemsList:timeRangeItems,allowedRanges:allowedRanges,sortFunc:timeSortFunc,isMultiselect:false,listClassName:"booking__buttons-list booking__buttons-list_type_time-ranges"})]})]}),sectionsVisibility.spotsSection.isVisible&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("section",{className:"booking__section","aria-label":"Секция выбора рабочего места",children:[(0,jsx_runtime.jsxs)("header",{className:"booking__section-header",children:[(0,jsx_runtime.jsx)("h2",{className:"booking__section-title",children:"".concat(sectionsVisibility.spotsSection.stepNumber,". Выберите ").concat(sectionsVisibility.isMobileView?"место":"тип рабочего места")}),!sectionsVisibility.isMobileView&&(0,jsx_runtime.jsx)(Button.Z,{btnClass:"button_type_link-underline booking__photo-button",btnText:isPlanPhotoVisible?"Скрыть план помещения":"Посмотреть план помещения",onClick:function handleShowPlanPhoto(){setIsPlanPhotoVisible((function(prev){return!prev}))}})]}),(0,jsx_runtime.jsxs)("div",{className:"booking__flex-container booking__flex-container_type_spots",children:[(0,jsx_runtime.jsx)("a",{href:"/",onClick:function handlePlanPhotoClick(e){e.preventDefault()},className:(0,clsx.Z)({"booking__plan-photo-link":!0,"booking__plan-photo-link_visible":isPlanPhotoVisible||sectionsVisibility.isMobileView}),children:(0,jsx_runtime.jsx)("img",{className:(0,clsx.Z)({"booking__plan-photo":!0,"booking__plan-photo_visible":isPlanPhotoVisible||sectionsVisibility.isMobileView}),src:planPhoto,alt:"Схема коворкинга"})}),!sectionsVisibility.isMobileView&&(0,jsx_runtime.jsx)(TabSwitcher.r,{firstCaption:constants.RU,secondCaption:constants.mb,containerClassName:"booking__spot-switcher",onClick:handleSwitcherClick}),(0,jsx_runtime.jsxs)("div",{className:"booking__tabs-container",children:[(0,jsx_runtime.jsx)("section",{className:(0,clsx.Z)({booking__tab:!0,booking__tab_disabled:isMeetingRoomsEnabled&&!isSpotsEnabled&&!sectionsVisibility.isMobileView,booking__tab_hidden:(!isWorkplacesEnabled||!isSpotsEnabled)&&sectionsVisibility.isMobileView}),"aria-hidden":!isWorkplacesEnabled||!isSpotsEnabled,children:sectionsVisibility.isMobileView?(0,jsx_runtime.jsx)(SortData.Z,{handleSelectChange:function handleSpotDropdownSelect(_ref2){var spot=_ref2.spot,foundSpot=spots.find((function(item){return item.name===spot}));setSpotsSelected(foundSpot?function(prev){return[].concat((0,toConsumableArray.Z)(prev),[foundSpot])}:[])},selectName:"spot",titleSort:"",array:permittedSpots,size:"medium",isDisabled:!0,className:"booking__spots-dropdown",shouldDropSelected:!(isWorkplacesEnabled&&isSpotsEnabled&&datesSelected.length>0&&timeRangesSelected.length>0)}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h3",{className:"booking__tab-title",children:"Одна цифра - одно рабочее место"}),(0,jsx_runtime.jsx)("p",{className:"booking__spot-price",children:currentSpotPrice}),(0,jsx_runtime.jsx)(ButtonsList.C,{isEnabled:isWorkplacesEnabled&&isSpotsEnabled&&datesSelected.length>0&&timeRangesSelected.length>0,listType:"spots",itemsList:spots,sortFunc:spotsSortFunc,listClassName:"booking__buttons-list booking__buttons-list_type_spots"})]})}),(0,jsx_runtime.jsxs)("section",{className:(0,clsx.Z)({booking__tab:!0,booking__tab_disabled:isSpotsEnabled&&!isMeetingRoomsEnabled&&!sectionsVisibility.isMobileView,booking__tab_hidden:(!isWorkplacesEnabled||!isMeetingRoomsEnabled)&&sectionsVisibility.isMobileView}),"aria-hidden":!isWorkplacesEnabled||!isMeetingRoomsEnabled,children:[!sectionsVisibility.isMobileView&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h3",{className:"booking__tab-title",children:"В одной переговорной 8 мест"}),(0,jsx_runtime.jsx)("p",{className:"booking__spot-price",children:currentMeetingPrice})]}),(0,jsx_runtime.jsx)(ButtonsList.C,{isEnabled:isWorkplacesEnabled&&isMeetingRoomsEnabled&&datesSelected.length>0&&timeRangesSelected.length>0,listType:"meeting-rooms",itemsList:meetingRooms,sortFunc:spotsSortFunc,listClassName:"booking__buttons-list booking__buttons-list_type_meeting-rooms"})]})]})]})]}),(0,jsx_runtime.jsxs)("section",{className:"booking__section","aria-label":"Секция итоговой суммы к оплате",children:[!sectionsVisibility.isMobileView&&(0,jsx_runtime.jsx)("h2",{className:"booking__section-title",children:"Сумма к оплате: ".concat(totalPrice)}),(0,jsx_runtime.jsx)(Button.Z,{btnClass:"button_type_form button_size_middle booking__pay-button",btnText:"Перейти к оплате",isValidBtn:!!totalPrice,onClick:function handlePayClick(){return(_ref3=_ref3||(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee2(){var _spotsSelected$at,workplaceCategory,selectedWorkplaces,selectedSpotId,selectedDate,timeSeleted,_timeSeleted$at,startTime,_timeSeleted$at2,endTime,_yield$postOrder,orderId;return(0,regeneratorRuntime.Z)().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return workplaceCategory=constants.Zq,selectedWorkplaces=spotsSelected.map((function(item){return item.name})).join(", "),selectedSpotId=null===(_spotsSelected$at=spotsSelected.at(0))||void 0===_spotsSelected$at?void 0:_spotsSelected$at.id,selectedDate=datesSelected.at(0),timeSeleted=(0,toConsumableArray.Z)(timeRangesSelected).sort(timeSortFunc),_timeSeleted$at=timeSeleted.at(0),startTime=_timeSeleted$at.startTime,_timeSeleted$at2=timeSeleted.at(-1),endTime=_timeSeleted$at2.endTime,meetingRoomsSelected.length>0&&(selectedSpotId=meetingRoomsSelected.at(0).id,workplaceCategory=constants.Yi,selectedWorkplaces=meetingRoomsSelected.map((function(item){return item.name})).join(", ")),_context2.prev=8,_context2.next=11,(0,Api.mv)(coworking.current.id,selectedSpotId,{date:getDateString(selectedDate),start_time:startTime,end_time:endTime});case 11:_yield$postOrder=_context2.sent,orderId=_yield$postOrder.id,navigate("/payments",{state:{id:coworking.current.id,spotId:selectedSpotId,name:coworking.current.name,location:coworking.current.location,category:workplaceCategory,equipment:selectedWorkplaces,date:selectedDate,startTime:startTime,endTime:endTime,bill:totalPrice,orderId:orderId}}),_context2.next=19;break;case 16:_context2.prev=16,_context2.t0=_context2.catch(8),showMessage("Бронирование доступно после авторизации");case 19:case"end":return _context2.stop()}}),_callee2,null,[[8,16]])})))).apply(this,arguments)}})]})]})]})};Booking_Booking.defaultProps={location:{id:null,openTime:null,closeTime:null,daysOpen:null}},Booking_Booking.__docgenInfo={description:"",methods:[],displayName:"Booking",props:{location:{defaultValue:{value:"{\n  id: null,\n  openTime: null,\n  closeTime: null,\n  daysOpen: null,\n}",computed:!1},description:"",type:{name:"shape",value:{id:{name:"number",required:!1},openTime:{name:"string",required:!1},closeTime:{name:"string",required:!1},daysOpen:{name:"string",required:!1}}},required:!1}}};var _Example$parameters,_Example$parameters2,_Example$parameters2$,exampleBookingData=__webpack_require__("./src/config/exampleBookingData.js"),Booking_stories={title:"Pages/Booking",component:Booking_Booking,tags:["autodocs"],parameters:{layout:"fullscreen"},argTypes:{location:{description:"Данные коворкинга"}}},Example=function Example(){return(0,jsx_runtime.jsx)(Booking_Booking,{location:exampleBookingData.zd})};Example.parameters=(0,objectSpread2.Z)((0,objectSpread2.Z)({},Example.parameters),{},{docs:(0,objectSpread2.Z)((0,objectSpread2.Z)({},null===(_Example$parameters=Example.parameters)||void 0===_Example$parameters?void 0:_Example$parameters.docs),{},{source:(0,objectSpread2.Z)({originalSource:"() => <Booking location={locationData} />"},null===(_Example$parameters2=Example.parameters)||void 0===_Example$parameters2||null===(_Example$parameters2$=_Example$parameters2.docs)||void 0===_Example$parameters2$?void 0:_Example$parameters2$.source)})});var __namedExportsOrder=["Example"];Example.__docgenInfo={description:"",methods:[],displayName:"Example"}},"./src/components/BookingCalendarPopup/BookingCalendarPopup.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return components_BookingCalendarPopup_BookingCalendarPopup}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),clsx=__webpack_require__("./node_modules/clsx/dist/clsx.mjs"),Calendar=__webpack_require__("./src/components/Calendar/Calendar.jsx"),ButtonsList=__webpack_require__("./src/components/ButtonsList/ButtonsList.jsx"),Button=__webpack_require__("./src/components/UI-kit/Button/Button.jsx"),Popup=__webpack_require__("./src/components/Popup/Popup.jsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),BookingCalendarPopup_BookingCalendarPopup=function BookingCalendarPopup(_ref){var isOpen=_ref.isOpen,timeListProps=_ref.timeListProps,onDateSelect=_ref.onDateSelect,onClickClose=_ref.onClickClose,onSaveClick=_ref.onSaveClick,popupClass=_ref.popupClass;return(0,jsx_runtime.jsxs)(Popup.Z,{isOpen:isOpen,onClickClose:onClickClose,popupSectionClass:"booking-calendar-popup",popupClass:(0,clsx.Z)((0,defineProperty.Z)({"booking-calendar-popup__container":!0},popupClass,popupClass)),popupCloseButtonClass:"booking-calendar-popup__close-button",children:[(0,jsx_runtime.jsx)(Calendar.f,{selectCallback:onDateSelect}),(0,jsx_runtime.jsxs)("div",{className:"booking-calendar-popup__controls-wrapper",children:[(0,jsx_runtime.jsx)(ButtonsList.C,(0,objectSpread2.Z)({},timeListProps)),(0,jsx_runtime.jsx)(Button.Z,{onClick:onSaveClick,btnClass:"booking-calendar-popup__save-button button_type_form",btnText:"Сохранить"})]})]})};BookingCalendarPopup_BookingCalendarPopup.defaultProps={isOpen:!0,popupClass:"",onClickClose:function onClickClose(){},onSaveClick:function onSaveClick(){}},BookingCalendarPopup_BookingCalendarPopup.__docgenInfo={description:"",methods:[],displayName:"BookingCalendarPopup",props:{isOpen:{defaultValue:{value:"true",computed:!1},description:"",type:{name:"bool"},required:!1},popupClass:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},onClickClose:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},onSaveClick:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},timeListProps:{description:"",type:{name:"shape",value:{itemsList:{name:"arrayOf",value:{name:"shape",value:{id:{name:"number",required:!1},name:{name:"string",required:!1},onClick:{name:"func",required:!1},isEnabled:{name:"bool",required:!1}}},required:!0},allowedRanges:{name:"arrayOf",value:{name:"arrayOf",value:{name:"number"}},required:!1},sortFunc:{name:"func",required:!1},isMultiselect:{name:"bool",required:!1},listClassName:{name:"string",required:!1}}},required:!0},onDateSelect:{description:"",type:{name:"func"},required:!0}}};var components_BookingCalendarPopup_BookingCalendarPopup=BookingCalendarPopup_BookingCalendarPopup},"./src/components/Calendar/Calendar.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{f:function(){return Calendar_Calendar}});var toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),constants=__webpack_require__("./src/utils/constants.jsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),getStartDayOfWeek=function getStartDayOfWeek(date){var dayNumber=new Date(date.getFullYear(),date.getMonth(),1).getDay();return 0===dayNumber?7:dayNumber},getMonthDays=function getMonthDays(date){return new Date(date.getFullYear(),date.getMonth()+1,0).getDate()},Calendar_Calendar=function Calendar(_ref){var _ref$selectCallback=_ref.selectCallback,selectCallback=void 0===_ref$selectCallback?null:_ref$selectCallback,_ref$isMultiSelect=_ref.isMultiSelect,isMultiSelect=void 0!==_ref$isMultiSelect&&_ref$isMultiSelect,_ref$initialDate=_ref.initialDate,initialDate=void 0===_ref$initialDate?null:_ref$initialDate,_ref$maxDatesRange=_ref.maxDatesRange,maxDatesRange=void 0===_ref$maxDatesRange?constants.VE:_ref$maxDatesRange,_ref$extraRules=_ref.extraRules,extraRules=void 0===_ref$extraRules?null:_ref$extraRules,MONTHS_NAMES=["ЯНВАРЬ","ФЕВРАЛЬ","МАРТ","АПРЕЛЬ","МАЙ","ИЮНЬ","ИЮЛЬ","АВГУСТ","СЕНТЯБРЬ","ОКТЯБРЬ","НОЯБРЬ","ДЕКАБРЬ"],todayDate=new Date,lastPermitedDate=new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()+maxDatesRange-1),_useState=(0,react.useState)(todayDate),_useState2=(0,slicedToArray.Z)(_useState,2),date=_useState2[0],setDate=_useState2[1],_useState3=(0,react.useState)([]),_useState4=(0,slicedToArray.Z)(_useState3,2),selectedDates=_useState4[0],setSelectedDates=_useState4[1],_useState5=(0,react.useState)(date.getMonth()),_useState6=(0,slicedToArray.Z)(_useState5,2),month=_useState6[0],setMonth=_useState6[1],_useState7=(0,react.useState)(date.getFullYear()),_useState8=(0,slicedToArray.Z)(_useState7,2),year=_useState8[0],setYear=_useState8[1],_useState9=(0,react.useState)(getStartDayOfWeek(date)),_useState10=(0,slicedToArray.Z)(_useState9,2),startDay=_useState10[0],setStartDay=_useState10[1],_useState11=(0,react.useState)(getMonthDays(date)),_useState12=(0,slicedToArray.Z)(_useState11,2),currentMonthDays=_useState12[0],setCurrentMonthDays=_useState12[1],days=new Date(date.getFullYear(),date.getMonth()+1,0).getDate(),isDateSelected=function isDateSelected(dateArray,cellDate){return dateArray.some((function(selectedDate){return selectedDate.getTime()===cellDate.getTime()}))},getCellContentClass=function getCellContentClass(nowDate,cellDay,currentDate,monthDays){var cellDate=new Date(currentDate.getFullYear(),currentDate.getMonth(),cellDay);return isDateSelected(selectedDates,cellDate)?" calendar__button_highlighted":cellDay<1?" calendar__button_previous-month":cellDay>monthDays?" calendar__button_next-month":function isDayDateEarlier(firstDate,secondDate){var firstDay=new Date(firstDate.getFullYear(),firstDate.getMonth(),firstDate.getDate()),secondDay=new Date(secondDate.getFullYear(),secondDate.getMonth(),secondDate.getDate());return firstDay.getTime()<secondDay.getTime()}(cellDate,nowDate)||function isDayDateLater(firstDate,secondDate){var firstDay=new Date(firstDate.getFullYear(),firstDate.getMonth(),firstDate.getDate()),secondDay=new Date(secondDate.getFullYear(),secondDate.getMonth(),secondDate.getDate());return firstDay.getTime()>secondDay.getTime()}(cellDate,lastPermitedDate)||extraRules&&!function isDateAllowed(currentDate){return Array.isArray(extraRules)?!extraRules.some((function(checkFunc){return checkFunc(currentDate)})):null}(cellDate)?" calendar__button_inaccessible-days":""};return(0,react.useEffect)((function(){setMonth(date.getMonth()),setYear(date.getFullYear()),setStartDay(getStartDayOfWeek(date)),setCurrentMonthDays(getMonthDays(date))}),[date]),(0,react.useEffect)((function(){initialDate&&setDate(new Date(initialDate))}),[initialDate]),(0,react.useEffect)((function(){selectCallback&&selectCallback(selectedDates)}),[selectedDates,selectCallback]),(0,jsx_runtime.jsxs)("article",{className:"calendar",children:[(0,jsx_runtime.jsxs)("header",{className:"calendar__header",children:[(0,jsx_runtime.jsx)("h3",{className:"calendar__header-title",children:"".concat(MONTHS_NAMES[month]," ").concat(year)}),(0,jsx_runtime.jsxs)("nav",{className:"calendar__navigation",children:[(0,jsx_runtime.jsx)("button",{className:"calendar__navigation-button calendar__navigation-button_type_previous","aria-label":"Предыдущий месяц",onClick:function handlePreviousClick(){setDate(new Date(date.getFullYear(),date.getMonth(),0))}}),(0,jsx_runtime.jsx)("button",{className:"calendar__navigation-button calendar__navigation-button_type_next","aria-label":"Следующий месяц",onClick:function handleNextClick(){setDate(new Date(date.getFullYear(),date.getMonth()+1,1))}})]})]}),(0,jsx_runtime.jsxs)("div",{className:"calendar__body",children:[["пн","вт","ср","чт","пт","сб","вс"].map((function(dayName){return(0,jsx_runtime.jsx)("div",{className:"calendar__cell calendar__cell_type_header",children:(0,jsx_runtime.jsx)("span",{children:dayName})},dayName)})),Array(function getCalendarDaysCount(daysOfMonth,startDayIndex){var resultDays=daysOfMonth+startDayIndex,daysRemainder=resultDays%7;return 0!==daysRemainder&&(resultDays+=7-daysRemainder),resultDays}(days,startDay-1)).fill(null).map((function(_,index){var cellDay=index-(startDay-2),key="cell".concat(index),cellText=function getCellText(cellDay,currentDate,monthDays){var resultDay=cellDay;return resultDay<1?new Date(currentDate.getFullYear(),currentDate.getMonth(),0).getDate()+resultDay:(resultDay>monthDays&&(resultDay-=monthDays),resultDay<10?"0".concat(resultDay):resultDay.toString())}(cellDay,date,currentMonthDays);return(0,jsx_runtime.jsx)("div",{className:"calendar__cell",children:(0,jsx_runtime.jsx)("button",{className:"calendar__button".concat(getCellContentClass(todayDate,cellDay,date,currentMonthDays)),onClick:function onClick(){return function handleCellClick(cellDay,monthDays){if(cellDay<1)setDate(new Date(date.getFullYear(),date.getMonth(),0));else if(cellDay>monthDays)setDate(new Date(date.getFullYear(),date.getMonth()+1,1));else{var cellDate=new Date(date.getFullYear(),date.getMonth(),cellDay);isDateSelected(selectedDates,cellDate)?setSelectedDates(selectedDates.filter((function(selectedDate){return selectedDate.getTime()!==cellDate.getTime()}))):setSelectedDates(isMultiSelect?function(prev){return[].concat((0,toConsumableArray.Z)(prev),[cellDate])}:[cellDate])}}(cellDay,currentMonthDays)},type:"button","aria-label":"".concat(MONTHS_NAMES[month]," ").concat(cellDay),children:cellText},"".concat(key,"button"))},key)}))]})]})};Calendar_Calendar.defaultProps={selectCallback:null,isMultiSelect:!1,initialDate:null,maxDatesRange:constants.VE,extraRules:null},Calendar_Calendar.__docgenInfo={description:"",methods:[],displayName:"Calendar",props:{selectCallback:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"func"},required:!1},isMultiSelect:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},initialDate:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},maxDatesRange:{defaultValue:{value:"CALENDAR_MAX_ALLOWED_DAYS",computed:!0},description:"",type:{name:"number"},required:!1},extraRules:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"arrayOf",value:{name:"func"}},required:!1}}}},"./src/components/Popup/Popup.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return components_Popup_Popup}});var defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),clsx=__webpack_require__("./node_modules/clsx/dist/clsx.mjs"),Button=__webpack_require__("./src/components/UI-kit/Button/Button.jsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function Popup_Popup(_ref){var isOpen=_ref.isOpen,children=_ref.children,onClickClose=_ref.onClickClose,popupClass=_ref.popupClass,popupSectionClass=_ref.popupSectionClass,popupCloseButtonClass=_ref.popupCloseButtonClass;return isOpen&&(0,jsx_runtime.jsx)("section",{className:(0,clsx.Z)((0,defineProperty.Z)({popup:!0},popupSectionClass,popupSectionClass)),"aria-label":"всплывающая форма",children:(0,jsx_runtime.jsxs)("div",{className:(0,clsx.Z)((0,defineProperty.Z)({popup__container:!0},popupClass,popupClass)),children:[children,(0,jsx_runtime.jsx)(Button.Z,{btnClass:(0,clsx.Z)((0,defineProperty.Z)({button_type_close:!0},popupCloseButtonClass,popupCloseButtonClass)),onClick:onClickClose})]})})}Popup_Popup.defaultProps={isOpen:!0,popupClass:"",popupSectionClass:"",popupCloseButtonClass:"",onClickClose:function onClickClose(){}},Popup_Popup.__docgenInfo={description:"",methods:[],displayName:"Popup",props:{isOpen:{defaultValue:{value:"true",computed:!1},description:"",type:{name:"bool"},required:!1},popupClass:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},popupSectionClass:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},popupCloseButtonClass:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},onClickClose:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},children:{description:"",type:{name:"union",value:[{name:"element"},{name:"node"}]},required:!0}}};var components_Popup_Popup=Popup_Popup},"./src/components/SectionTitle/SectionTitle.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{N:function(){return SectionTitle_SectionTitle}});__webpack_require__("./node_modules/react/index.js");var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),SectionTitle_SectionTitle=function SectionTitle(_ref){var titleText=_ref.titleText,titleClass=_ref.titleClass;return(0,jsx_runtime.jsx)("h2",{className:"section-title".concat(titleClass?" ".concat(titleClass):""),children:titleText})};SectionTitle_SectionTitle.defaultProps={titleText:"",titleClass:""},SectionTitle_SectionTitle.__docgenInfo={description:"",methods:[],displayName:"SectionTitle",props:{titleText:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},titleClass:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1}}}},"./src/components/TabSwitcher/TabSwitcher.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{r:function(){return TabSwitcher_TabSwitcher}});var slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),TabSwitcher_TabSwitcher=function TabSwitcher(_ref){var _ref$firstCaption=_ref.firstCaption,firstCaption=void 0===_ref$firstCaption?"":_ref$firstCaption,_ref$secondCaption=_ref.secondCaption,secondCaption=void 0===_ref$secondCaption?"":_ref$secondCaption,_ref$onClick=_ref.onClick,onClick=void 0===_ref$onClick?null:_ref$onClick,_ref$containerClassNa=_ref.containerClassName,containerClassName=void 0===_ref$containerClassNa?"":_ref$containerClassNa,_ref$itemClassName=_ref.itemClassName,itemClassName=void 0===_ref$itemClassName?"":_ref$itemClassName,_useState=(0,react.useState)(firstCaption),_useState2=(0,slicedToArray.Z)(_useState,2),selectedItem=_useState2[0],setSelectedItem=_useState2[1],handleClick=function handleClick(item){setSelectedItem(item),onClick&&onClick(item)},getItemClassName=function getItemClassName(item){var resultClassName="tab-switcher__item";return item===selectedItem&&(resultClassName+=" ".concat(resultClassName,"_active")),itemClassName&&(resultClassName+=" ".concat(itemClassName)),resultClassName};return(0,jsx_runtime.jsxs)("ul",{className:function getContainerClassName(){var resultClassName="tab-switcher".concat(containerClassName?" ".concat(containerClassName):"");return selectedItem===secondCaption&&(resultClassName+=" tab-switcher_second-selected"),resultClassName}(),children:[(0,jsx_runtime.jsx)("li",{children:(0,jsx_runtime.jsx)("button",{type:"button",className:getItemClassName(firstCaption),onClick:function onClick(){return handleClick(firstCaption)},children:firstCaption})}),(0,jsx_runtime.jsx)("li",{children:(0,jsx_runtime.jsx)("button",{type:"button",className:getItemClassName(secondCaption),onClick:function onClick(){return handleClick(secondCaption)},children:secondCaption})})]})};TabSwitcher_TabSwitcher.defaultProps={firstCaption:"",secondCaption:"",onClick:null,containerClassName:"",itemClassName:""},TabSwitcher_TabSwitcher.__docgenInfo={description:"",methods:[],displayName:"TabSwitcher",props:{firstCaption:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},secondCaption:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},onClick:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"func"},required:!1},containerClassName:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},itemClassName:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1}}}},"./src/components/UI-kit/SortData/SortData.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return UI_kit_SortData_SortData}});var defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/clsx/dist/clsx.mjs"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),SortData_SortData=function SortData(_ref){var _clsx,titleSort=_ref.titleSort,array=_ref.array,size=_ref.size,handleSelectChange=_ref.handleSelectChange,selectName=_ref.selectName,className=_ref.className,_ref$shouldDropSelect=_ref.shouldDropSelected,shouldDropSelected=void 0!==_ref$shouldDropSelect&&_ref$shouldDropSelect,sortRef=react.useRef(null),_React$useState=react.useState(!1),_React$useState2=(0,slicedToArray.Z)(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1],_React$useState3=react.useState(""),_React$useState4=(0,slicedToArray.Z)(_React$useState3,2),sort=_React$useState4[0],setSort=_React$useState4[1];return react.useEffect((function(){var handleClickOutside=function handleClickOutside(event){sortRef.current&&!sortRef.current.contains(event.target)&&setOpen(!1)};return document.body.addEventListener("click",handleClickOutside),function(){return document.body.removeEventListener("click",handleClickOutside)}}),[]),(0,react.useEffect)((function(){shouldDropSelected&&setSort("")}),[shouldDropSelected]),(0,jsx_runtime.jsx)("section",{ref:sortRef,className:(0,clsx.Z)((_clsx={sort:!0},(0,defineProperty.Z)(_clsx,"sort_size-".concat(size),size),(0,defineProperty.Z)(_clsx,className,className),_clsx)),"aria-label":"фильтр коворкингов ".concat(titleSort," "),children:(0,jsx_runtime.jsxs)("div",{className:"sort__items sort__items_size-".concat(size," ").concat(open&&"sort__items_active"," "),children:[(0,jsx_runtime.jsxs)("div",{className:"sort__label",children:[(0,jsx_runtime.jsx)("p",{className:"sort__label_text",children:sort||titleSort}),(0,jsx_runtime.jsx)("button",{type:"button",className:"sort__label_button   ".concat(open&&"sort__label_button-active"," "),onClick:function onClick(){return setOpen(!open)},tabIndex:0,"aria-label":"кнопка открытия выпадающего меню"})]}),open&&(0,jsx_runtime.jsx)("div",{className:"sort__popup",children:(0,jsx_runtime.jsx)("ul",{className:"sort__popup_list",children:array.map((function(data){return(0,jsx_runtime.jsxs)("button",{onClick:function onClick(){return function onClickListItem(obj){var newSort="--"===obj.text?"":obj.text;setSort(newSort),handleSelectChange((0,defineProperty.Z)({},selectName,newSort)),setOpen(!1)}(data)},className:"sort__popup_list-active",children:[data.icon,data.text]},data.id)}))})})]})})};SortData_SortData.defaultProps={size:"",array:[{icon:{}}],className:"",shouldDropSelected:!1},SortData_SortData.__docgenInfo={description:"",methods:[],displayName:"SortData",props:{shouldDropSelected:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},size:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},array:{defaultValue:{value:"[{ icon: {} }]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"shape",value:{id:{name:"number",required:!0},text:{name:"string",required:!0},icon:{name:"shape",value:{},required:!1}}}},required:!1},className:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},titleSort:{description:"",type:{name:"string"},required:!0},handleSelectChange:{description:"",type:{name:"func"},required:!0},selectName:{description:"",type:{name:"string"},required:!0}}};var UI_kit_SortData_SortData=SortData_SortData},"./src/contexts/currentUserContext.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{E:function(){return CurrentUserContext}});var CurrentUserContext=__webpack_require__("./node_modules/react/index.js").createContext()},"./src/hooks/useResize.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{a:function(){return useResize}});var _home_runner_work_book_it_coworking_frontend_book_it_coworking_frontend_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_utils_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/utils/constants.jsx"),useResize=function useResize(){var _useState=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(0),_useState2=(0,_home_runner_work_book_it_coworking_frontend_book_it_coworking_frontend_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_useState,2),width=_useState2[0],setWidth=_useState2[1];return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var handleResize=function handleResize(){return setWidth(window.innerWidth)};return handleResize(),setTimeout((function(){window.addEventListener("resize",handleResize)}),500),function(){window.removeEventListener("resize",handleResize)}}),[]),{width:width,isScreenSmall:width<_utils_constants__WEBPACK_IMPORTED_MODULE_1__.l0,isScreenMedium:width<_utils_constants__WEBPACK_IMPORTED_MODULE_1__.Q2,isScreenMediumTablet:width<_utils_constants__WEBPACK_IMPORTED_MODULE_1__.uG,isScreenLarge:width>_utils_constants__WEBPACK_IMPORTED_MODULE_1__.Q2}}},"./src/utils/Api.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function checkResponse(res){return res.ok?res.json():res.json().then((function(errorResponse){return errorResponse?Promise.reject(errorResponse):Promise.reject(new Error("Ошибка ".concat(res.statusText," ").concat(res.status)))}))}function request(url,options){return fetch("https://spotit.acceleratorpracticum.ru/api/v1".concat(url),options).then(checkResponse)}function setHeaders(){var token=localStorage.getItem("token");return token?{Authorization:"Token ".concat(token),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}function register(_ref){var email=_ref.email,password=_ref.password,first_name=_ref.first_name,last_name=_ref.last_name,re_password=_ref.re_password;return request("/users/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:email,password:password,first_name:first_name,last_name:last_name,re_password:re_password})})}function confirmRegister(_ref2){var email=_ref2.email,confirmation_code=_ref2.confirmation_code;return request("/users/activation/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:email,confirmation_code:confirmation_code})})}function resetPassConfirmCode(_ref4){var email=_ref4.email;return request("/users/reset_password_confirmation_code/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:email})})}function resetPass(_ref5){var email=_ref5.email,confirmation_code=_ref5.confirmation_code,password=_ref5.password,re_password=_ref5.re_password;return request("/users/reset_password/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:email,confirmation_code:confirmation_code,password:password,re_password:re_password})})}function getShortLocations(limit,start){return request("/short_locations/?limit=".concat(limit,"&offset=").concat(start),{method:"GET",headers:setHeaders()})}function getMapLocations(){return request("/map_locations/",{method:"GET",headers:setHeaders()})}function getEvents(){return request("/events/",{method:"GET",headers:setHeaders()})}function getQuestions(){return request("/questions/",{method:"GET",headers:setHeaders()})}function getRules(){return request("/rules/",{method:"GET",headers:setHeaders()})}function getCoworkingInfo(id){return request("/locations/".concat(id,"/"),{method:"GET",headers:setHeaders()})}function getEquipment(id,category){return request("/locations/".concat(id,"/equipments/?category=").concat(category),{method:"GET",headers:setHeaders()})}function getReviews(id,limit,start){return request("/locations/".concat(id,"/reviews/?limit=").concat(limit,"&offset=").concat(start),{method:"GET",headers:setHeaders()})}function getActiveOrders(){return request("/orders/?finished=false",{method:"GET",headers:setHeaders()})}function getFinishedOrders(){return request("/orders/?finished=true",{method:"GET",headers:setHeaders()})}function publishReview(locationId,spotId,orderId,_ref6){var description=_ref6.description,rating=_ref6.rating;return request("/locations/".concat(locationId,"/spots/").concat(spotId,"/order/").concat(orderId,"/reviews/"),{method:"POST",headers:setHeaders(),body:JSON.stringify({description:description,rating:rating})})}function cancelOrder(locationId,spotId,orderId){return request("/locations/".concat(locationId,"/spots/").concat(spotId,"/order/").concat(orderId,"/"),{method:"PATCH",headers:setHeaders()})}function subscribe(){return request("/subscribe/",{method:"POST",headers:setHeaders()})}function editUserData(data){return request("/users/me/",{method:"PATCH",headers:setHeaders(),body:JSON.stringify(data)})}function editUserAvatar(data){return request("/avatar",{method:"PUT",headers:setHeaders(),body:JSON.stringify(data)})}function deleteUser(id){return request("/users/".concat(id,"/"),{method:"DELETE",headers:setHeaders()})}function changePass(_ref7){var current_password=_ref7.current_password,password=_ref7.password,re_password=_ref7.re_password;return request("/users/change_password/",{method:"POST",headers:setHeaders(),body:JSON.stringify({current_password:current_password,password:password,re_password:re_password})})}function addFavorite(id){return request("/locations/".concat(id,"/favorite/"),{method:"POST",headers:setHeaders()})}function deleteFavorite(id){return request("/locations/".concat(id,"/favorite/"),{method:"DELETE",headers:setHeaders()})}function getLocationPlanPhoto(id){return request("/locations/".concat(id,"/plan_photo/"),{method:"GET",headers:setHeaders()})}function getSpots(id,data){return request("/locations/".concat(id,"/spots/?").concat(new URLSearchParams(data)),{method:"GET",headers:setHeaders()})}function postOrder(locationId,spotId,data){return request("/locations/".concat(locationId,"/spots/").concat(spotId,"/order/"),{method:"POST",headers:setHeaders(),body:JSON.stringify(data)})}function searchLocations(){var params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},query=new URLSearchParams;return Object.keys(params).forEach((function(key){void 0!==params[key]&&null!==params[key]&&("metro"===key&&Array.isArray(params[key])?params[key].forEach((function(value){query.append("metro",value)})):query.append(key,params[key]))})),request("/locations/?".concat(query.toString()),{method:"GET",headers:setHeaders()})}function pay(locationId,spotId,orderId){return request("/locations/".concat(locationId,"/spots/").concat(spotId,"/order/").concat(orderId,"/pay/"),{method:"PATCH",headers:setHeaders()})}__webpack_require__.d(__webpack_exports__,{$c:function(){return getRules},BV:function(){return searchLocations},FW:function(){return editUserAvatar},GW:function(){return confirmRegister},Jh:function(){return getReviews},Ld:function(){return subscribe},QI:function(){return getMapLocations},T4:function(){return getSpots},Wm:function(){return resetPassConfirmCode},a3:function(){return addFavorite},c6:function(){return pay},fV:function(){return changePass},fZ:function(){return getShortLocations},h8:function(){return deleteUser},lQ:function(){return editUserData},mv:function(){return postOrder},pz:function(){return getFinishedOrders},qA:function(){return getCoworkingInfo},r7:function(){return deleteFavorite},sl:function(){return cancelOrder},tI:function(){return getQuestions},v5:function(){return getLocationPlanPhoto},vw:function(){return getEvents},xf:function(){return getEquipment},z2:function(){return register},zB:function(){return getActiveOrders},zL:function(){return resetPass},zU:function(){return publishReview}})}}]);